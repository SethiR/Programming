


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.2.2">
    
    
      
        <title>Java database with JDBC.org - Notes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a2408e81.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a46bcfb3.min.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="red">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#jdbc-basics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="Notes" class="md-header-nav__button md-logo" aria-label="Notes">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Notes
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Java database with JDBC.org
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
          

  

<nav class="md-tabs md-tabs--active" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Data/Hadoop/" class="md-tabs__link">
          Data
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Frontend/JS-01-Basics/" class="md-tabs__link">
          Frontend
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../Java-collections.org/" class="md-tabs__link md-tabs__link--active">
          Java
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Machine%20Learning/Linear%20Regression/" class="md-tabs__link">
          Machine Learning
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Misc/bash/" class="md-tabs__link">
          Misc
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Python/Arrays/" class="md-tabs__link">
          Python
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Notes" class="md-nav__button md-logo" aria-label="Notes">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Data
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Data" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Data/Hadoop/" title="Hadoop" class="md-nav__link">
      Hadoop
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Data/Kafka/" title="Kafka" class="md-nav__link">
      Kafka
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Data/SQL/" title="SQL" class="md-nav__link">
      SQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Data/Spark/" title="Spark" class="md-nav__link">
      Spark
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Data/scala/" title="Scala" class="md-nav__link">
      Scala
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Frontend
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Frontend" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Frontend
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Frontend/JS-01-Basics/" title="JS-01-Basics" class="md-nav__link">
      JS-01-Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Frontend/JS-02-Functions/" title="JS-02-Functions" class="md-nav__link">
      JS-02-Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Frontend/JS-03-Objects/" title="JS-03-Objects" class="md-nav__link">
      JS-03-Objects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Frontend/JS-04-Arrays/" title="JS-04-Arrays" class="md-nav__link">
      JS-04-Arrays
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Frontend/Tailwind%20CSS/" title="Tailwind CSS" class="md-nav__link">
      Tailwind CSS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Frontend/Web%20Technologies/" title="Web Technologies" class="md-nav__link">
      Web Technologies
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Frontend/the-circle-of-ds/" title="The circle of Data Science." class="md-nav__link">
      The circle of Data Science.
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Java
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Java" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Java-collections.org/" title="Java collections.org" class="md-nav__link">
      Java collections.org
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Java-core_java.org/" title="Java core java.org" class="md-nav__link">
      Java core java.org
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Java-core_platform.org/" title="Java core platform.org" class="md-nav__link">
      Java core platform.org
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Java database with JDBC.org
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Java database with JDBC.org" class="md-nav__link md-nav__link--active">
      Java database with JDBC.org
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#jdbc-basics" class="md-nav__link">
    JDBC Basics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jdbc-continued" class="md-nav__link">
    JDBC continued
  </a>
  
    <nav class="md-nav" aria-label="JDBC continued">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-crud-operations" class="md-nav__link">
    Basic CRUD operations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-stored-procedures" class="md-nav__link">
    Working with stored procedures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transaction-management-using-jdbc" class="md-nav__link">
    Transaction Management using JDBC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-clob-and-blob" class="md-nav__link">
    Working with CLOB and BLOB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-metadata" class="md-nav__link">
    Working with metadata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connection-pooling" class="md-nav__link">
    Connection pooling
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Java-design_patterns_creational.org/" title="Java design patterns creational.org" class="md-nav__link">
      Java design patterns creational.org
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Java-generics.org/" title="Java generics.org" class="md-nav__link">
      Java generics.org
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Java-overview_of_the_java_world.org/" title="Java overview of the java world.org" class="md-nav__link">
      Java overview of the java world.org
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Machine Learning
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Machine Learning" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Machine Learning
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Machine%20Learning/Linear%20Regression/" title="1. Regularization" class="md-nav__link">
      1. Regularization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Machine%20Learning/Logistic%20Regression/" title="Logistic Regression" class="md-nav__link">
      Logistic Regression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Machine%20Learning/MultiLayerPerceptron/" title="1. Multi Layer Perceptron" class="md-nav__link">
      1. Multi Layer Perceptron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Machine%20Learning/Overview%20of%20Supervised%20Learning/" title="Overview of Supervised Learning" class="md-nav__link">
      Overview of Supervised Learning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Machine%20Learning/Pandas/" title="Basics" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Machine%20Learning/Sklearn/" title="Sklearn" class="md-nav__link">
      Sklearn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Machine%20Learning/Terms/" title="Model Parameters" class="md-nav__link">
      Model Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-8" type="checkbox" id="nav-5-8">
    
    <label class="md-nav__link" for="nav-5-8">
      Nlp
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Nlp" data-md-level="2">
      <label class="md-nav__title" for="nav-5-8">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Nlp
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Machine%20Learning/nlp/NPL/" title="NPL" class="md-nav__link">
      NPL
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Misc
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Misc" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Misc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Misc/bash/" title="Bash/Shell Scripting" class="md-nav__link">
      Bash/Shell Scripting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Misc/linx/" title="Linux" class="md-nav__link">
      Linux
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Python
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Python" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Python
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Arrays/" title="Arrays" class="md-nav__link">
      Arrays
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Bytes/" title="Bytes" class="md-nav__link">
      Bytes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Callables/" title="Callables" class="md-nav__link">
      Callables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Collections/" title="Collections" class="md-nav__link">
      Collections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Context%20Managers/" title="Context Managers" class="md-nav__link">
      Context Managers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Data%20Model%20Methods/" title="Data Model Methods" class="md-nav__link">
      Data Model Methods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/DataClasses/" title="DataClasses" class="md-nav__link">
      DataClasses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Decorators/" title="Decorators" class="md-nav__link">
      Decorators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Dict/" title="Dict" class="md-nav__link">
      Dict
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Disassembler%20for%20Python%20bytecode/" title="Disassembler for Python bytecode" class="md-nav__link">
      Disassembler for Python bytecode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Enum/" title="Enum" class="md-nav__link">
      Enum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Exceptions/" title="Exceptions" class="md-nav__link">
      Exceptions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Functions/" title="Functions" class="md-nav__link">
      Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Generator/" title="Generator" class="md-nav__link">
      Generator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Isolating%20Envirounments%20in%20Python/" title="Isolating Envirounments in Python" class="md-nav__link">
      Isolating Envirounments in Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/List/" title="List" class="md-nav__link">
      List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/MRO/" title="MRO" class="md-nav__link">
      MRO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Sets/" title="Sets" class="md-nav__link">
      Sets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Slots/" title="Slots" class="md-nav__link">
      Slots
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Subclassing%20built-ins/" title="Subclassing built-ins" class="md-nav__link">
      Subclassing built-ins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Tuples/" title="Tuples" class="md-nav__link">
      Tuples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Weakref/" title="Weakref" class="md-nav__link">
      Weakref
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/django/" title="Django" class="md-nav__link">
      Django
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/foundations/" title="Foundations" class="md-nav__link">
      Foundations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/metaprogramming/" title="Metaprogramming" class="md-nav__link">
      Metaprogramming
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#jdbc-basics" class="md-nav__link">
    JDBC Basics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jdbc-continued" class="md-nav__link">
    JDBC continued
  </a>
  
    <nav class="md-nav" aria-label="JDBC continued">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-crud-operations" class="md-nav__link">
    Basic CRUD operations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-stored-procedures" class="md-nav__link">
    Working with stored procedures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transaction-management-using-jdbc" class="md-nav__link">
    Transaction Management using JDBC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-clob-and-blob" class="md-nav__link">
    Working with CLOB and BLOB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-metadata" class="md-nav__link">
    Working with metadata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connection-pooling" class="md-nav__link">
    Connection pooling
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                  <h1>Java database with JDBC.org</h1>
                
                <h2 id="jdbc-basics">JDBC Basics</h2>
<p><code>JDBC : Java Database Connectivity</code></p>
<p>(This section is from youtube)</p>
<p>Steps to connectivity - Import Package (java.sql) - Load &amp; Register the
driver (e.g. com.mysql.jdbc.driver from mysql.connector) - Establish
connection - Create the statement - Execute the query - Process Result -
Close the conection</p>
<hr />
<p><strong>Basic fetch value operation from database</strong></p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.sql.*</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestConnection</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span>
    <span class="p">{</span>
        <span class="n">Class</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="s">&quot;com.mysql.cj.jdbc.Driver&quot;</span><span class="p">);</span>
        <span class="n">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="s">&quot;jdbc:mysql://localhost:3306/world&quot;</span><span class="p">,</span><span class="s">&quot;admin&quot;</span><span class="p">,</span><span class="s">&quot;admin&quot;</span><span class="p">);</span>

<span class="c1">//        String query = &quot;select * from country where Code = \&quot;IND\&quot;&quot;;</span>
        <span class="n">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">&quot;select * from country&quot;</span><span class="p">;</span>
        <span class="n">Statement</span> <span class="n">st</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span>

        <span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>
<span class="c1">//        rs.next();</span>

        <span class="k">while</span> <span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">next</span><span class="p">())</span>
        <span class="p">{</span>
            <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">st</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">con</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<hr />
<p><strong>Inserting Values into the database</strong></p>
<ul>
<li>
<p>DDL --> Data Definition Language (Create table, change database
    etc...)</p>
<ul>
<li>Use --> st.executeUpdate(query)</li>
</ul>
</li>
<li>
<p>DML --> Data Manipulation Language (INSERT, UPDATE and DELETE
    statements)</p>
<ul>
<li>Use --> st.executeUpdate(query)</li>
</ul>
</li>
<li>
<p>DQL --> Data Query Language (SELECT, SHOW and HELP statements)</p>
<ul>
<li>Use --> st.executeQuery(query)</li>
</ul>
</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="cm">/*</span>
<span class="cm">DDL --&gt; Data Definition Language (Create table, change database etc...)</span>

<span class="cm">DML --&gt; Data Manipulation Language (INSERT, UPDATE and DELETE statements)</span>
<span class="cm">Use --&gt; st.executeUpdate(query)</span>

<span class="cm">DQL --&gt; Data Query Language (SELECT, SHOW and HELP statements)</span>
<span class="cm">Use --&gt; st.executeQuery(query)</span>
<span class="cm"> */</span>

<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.DriverManager</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Statement</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">InsertingValuesStringQuery</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span>
    <span class="p">{</span>
        <span class="n">Class</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="s">&quot;com.mysql.cj.jdbc.Driver&quot;</span><span class="p">);</span>
        <span class="n">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="s">&quot;jdbc:mysql://localhost:3306/test&quot;</span><span class="p">,</span><span class="s">&quot;admin&quot;</span><span class="p">,</span><span class="s">&quot;admin&quot;</span><span class="p">);</span>

        <span class="n">Statement</span> <span class="n">st</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span>

        <span class="n">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">&quot;insert into customer (firstName, lastName, email, dob) values (&#39;Sheldon&#39;, &#39;Cooper&#39;, &#39;Sheldon.Cooper@gmail.com&#39;, &#39;1973-01-01&#39;)&quot;</span><span class="p">;</span>

        <span class="kt">int</span> <span class="n">rowsAffected</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Number of row(s) affected : &quot;</span> <span class="o">+</span> <span class="n">rowsAffected</span><span class="p">);</span>

        <span class="n">st</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">con</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>

    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<hr />
<p>Use preparedStatement to build query instead of passing the whole
string. In this case you can use some variables as well to prepare
statement. The below example asks data from the user and inserts into
the database.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.DriverManager</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="p">;</span>


<span class="kd">public</span> <span class="kd">class</span> <span class="nc">InsertingValuesPreparedStatement</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span>
    <span class="p">{</span>
        <span class="n">Class</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="s">&quot;com.mysql.cj.jdbc.Driver&quot;</span><span class="p">);</span>
        <span class="n">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="s">&quot;jdbc:mysql://localhost:3306/test&quot;</span><span class="p">,</span><span class="s">&quot;admin&quot;</span><span class="p">,</span><span class="s">&quot;admin&quot;</span><span class="p">);</span>

        <span class="n">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">&quot;insert into customer (firstName, lastName, email, dob) values (?, ?, ?, ?)&quot;</span><span class="p">;</span>
        <span class="n">PreparedStatement</span> <span class="n">st</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>

        <span class="n">String</span> <span class="n">firstName</span> <span class="o">=</span> <span class="n">getUserInput</span><span class="p">(</span><span class="s">&quot;Enter your first name : &quot;</span><span class="p">);</span>
        <span class="n">String</span> <span class="n">lastName</span> <span class="o">=</span> <span class="n">getUserInput</span><span class="p">(</span><span class="s">&quot;Enter your last name : &quot;</span><span class="p">);</span>
        <span class="n">String</span> <span class="n">email</span> <span class="o">=</span> <span class="n">getUserInput</span><span class="p">(</span><span class="s">&quot;Enter your email : &quot;</span><span class="p">);</span>
        <span class="n">String</span> <span class="n">dob</span> <span class="o">=</span> <span class="n">getUserInput</span><span class="p">(</span><span class="s">&quot;Enter your dob in yyyy-mm-dd format : &quot;</span><span class="p">);</span>

        <span class="n">st</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">firstName</span><span class="p">);</span>
        <span class="n">st</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">lastName</span><span class="p">);</span>
        <span class="n">st</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">email</span><span class="p">);</span>
        <span class="n">st</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">dob</span><span class="p">);</span>

        <span class="kt">int</span> <span class="n">rowsAffected</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Number of row(s) affected : &quot;</span> <span class="o">+</span> <span class="n">rowsAffected</span><span class="p">);</span>

        <span class="n">st</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">con</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">getUserInput</span><span class="p">(</span><span class="n">String</span> <span class="n">message</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Scanner</span> <span class="n">scan</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">scan</span><span class="p">.</span><span class="na">nextLine</span><span class="p">().</span><span class="na">strip</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<hr />
<p>Using SQLite</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.DriverManager</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestConnectionSQLite</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span>
    <span class="p">{</span>
<span class="c1">//        Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span>
        <span class="n">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="s">&quot;jdbc:sqlite:C:/Users/182362434/dbA.db&quot;</span><span class="p">);</span>

        <span class="n">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">&quot;insert into customer (firstName, lastName, email, dob) values (?, ?, ?, ?)&quot;</span><span class="p">;</span>
        <span class="n">PreparedStatement</span> <span class="n">st</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>

        <span class="n">String</span> <span class="n">firstName</span> <span class="o">=</span> <span class="n">getUserInput</span><span class="p">(</span><span class="s">&quot;Enter your first name : &quot;</span><span class="p">);</span>
        <span class="n">String</span> <span class="n">lastName</span> <span class="o">=</span> <span class="n">getUserInput</span><span class="p">(</span><span class="s">&quot;Enter your last name : &quot;</span><span class="p">);</span>
        <span class="n">String</span> <span class="n">email</span> <span class="o">=</span> <span class="n">getUserInput</span><span class="p">(</span><span class="s">&quot;Enter your email : &quot;</span><span class="p">);</span>
        <span class="n">String</span> <span class="n">dob</span> <span class="o">=</span> <span class="n">getUserInput</span><span class="p">(</span><span class="s">&quot;Enter your dob in yyyy-mm-dd format : &quot;</span><span class="p">);</span>

        <span class="n">st</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">firstName</span><span class="p">);</span>
        <span class="n">st</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">lastName</span><span class="p">);</span>
        <span class="n">st</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">email</span><span class="p">);</span>
        <span class="n">st</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">dob</span><span class="p">);</span>

        <span class="kt">int</span> <span class="n">rowsAffected</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Number of row(s) affected : &quot;</span> <span class="o">+</span> <span class="n">rowsAffected</span><span class="p">);</span>

        <span class="n">st</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">con</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">getUserInput</span><span class="p">(</span><span class="n">String</span> <span class="n">message</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Scanner</span> <span class="n">scan</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">scan</span><span class="p">.</span><span class="na">nextLine</span><span class="p">().</span><span class="na">strip</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<hr />
<p>Creating a DAO using SQLite.</p>
<div class="codehilite"><pre><span></span><code><span class="cm">/*</span>
<span class="cm">A data access object (DAO) is an object that provides an abstract interface to</span>
<span class="cm">some type of database or other persistence mechanism.</span>
<span class="cm">The DAO should do the CRUD operations.</span>
<span class="cm"> */</span>

<span class="kn">import</span> <span class="nn">java.sql.*</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">Person</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">id</span><span class="p">;</span>
    <span class="n">String</span> <span class="n">firstName</span><span class="p">;</span>
    <span class="n">String</span> <span class="n">lastName</span><span class="p">;</span>
    <span class="n">String</span> <span class="n">email</span><span class="p">;</span>
    <span class="n">String</span> <span class="n">dob</span><span class="p">;</span>

    <span class="n">Person</span><span class="p">(){}</span>

    <span class="kd">public</span> <span class="nf">Person</span><span class="p">(</span><span class="n">String</span> <span class="n">firstName</span><span class="p">,</span> <span class="n">String</span> <span class="n">lastName</span><span class="p">,</span> <span class="n">String</span> <span class="n">email</span><span class="p">,</span> <span class="n">String</span> <span class="n">dob</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">firstName</span> <span class="o">=</span> <span class="n">firstName</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">lastName</span> <span class="o">=</span> <span class="n">lastName</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">email</span> <span class="o">=</span> <span class="n">email</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">dob</span> <span class="o">=</span> <span class="n">dob</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;Person{id = &quot;</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">&quot;, firstName = &quot;</span> <span class="o">+</span> <span class="n">firstName</span> <span class="o">+</span> <span class="s">&quot;, lastName = &quot;</span> <span class="o">+</span> <span class="n">lastName</span> <span class="o">+</span>
                <span class="s">&quot;, email = &quot;</span> <span class="o">+</span> <span class="n">email</span> <span class="o">+</span> <span class="s">&quot;, dob = &quot;</span> <span class="o">+</span> <span class="n">dob</span> <span class="o">+</span> <span class="s">&quot;}&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">PersonDAO</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="n">Person</span> <span class="nf">getPerson</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span>
    <span class="p">{</span>
        <span class="k">try</span>
        <span class="p">{</span>

            <span class="n">Person</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">();</span>
            <span class="n">p</span><span class="p">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="p">;</span>

            <span class="n">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">&quot;Select * from Customer where id = &quot;</span> <span class="o">+</span> <span class="n">id</span><span class="p">;</span>

            <span class="n">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="s">&quot;jdbc:sqlite:C:/Users/182362434/dbA.db&quot;</span><span class="p">);</span>
            <span class="n">Statement</span> <span class="n">st</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span>
            <span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>
            <span class="n">rs</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>

            <span class="n">p</span><span class="p">.</span><span class="na">firstName</span> <span class="o">=</span> <span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;firstName&quot;</span><span class="p">);</span>
            <span class="n">p</span><span class="p">.</span><span class="na">lastName</span> <span class="o">=</span> <span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;lastName&quot;</span><span class="p">);</span>
            <span class="n">p</span><span class="p">.</span><span class="na">dob</span> <span class="o">=</span> <span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;dob&quot;</span><span class="p">);</span>

            <span class="n">st</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
            <span class="n">con</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">p</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">addPerson</span><span class="p">(</span><span class="n">Person</span> <span class="n">p</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span><span class="p">{</span>

        <span class="n">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="s">&quot;jdbc:sqlite:C:/Users/182362434/dbA.db&quot;</span><span class="p">);</span>
        <span class="n">PreparedStatement</span> <span class="n">st</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="s">&quot;insert into customer (firstName, lastName, email, dob) values (?, ?, ?, ?)&quot;</span><span class="p">);</span>

        <span class="n">st</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="na">firstName</span><span class="p">);</span>
        <span class="n">st</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="na">lastName</span><span class="p">);</span>
        <span class="n">st</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="na">email</span><span class="p">);</span>
        <span class="n">st</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="na">dob</span><span class="p">);</span>

        <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span>  <span class="n">st</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>

        <span class="n">st</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">con</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>

        <span class="k">return</span> <span class="n">result</span><span class="p">;</span>

    <span class="p">}</span>

<span class="p">}</span>

<span class="c1">// Main class from here onwards. If you see below the main class is executing simple looking statements.</span>
<span class="c1">// Its very abstract here.</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JdbcDaoDemo</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span>
    <span class="p">{</span>
        <span class="n">PersonDAO</span> <span class="n">dao</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PersonDAO</span><span class="p">();</span>

        <span class="c1">// Getting someone with id = 1</span>
        <span class="n">Person</span> <span class="n">p</span> <span class="o">=</span> <span class="n">dao</span><span class="p">.</span><span class="na">getPerson</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>

        <span class="c1">// Getting someone with id = 2</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">dao</span><span class="p">.</span><span class="na">getPerson</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>

        <span class="c1">// Inserting someone into the database and then fetching him and displaying the value.</span>
        <span class="n">Person</span> <span class="n">raj</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">(</span><span class="s">&quot;Raj&quot;</span><span class="p">,</span> <span class="s">&quot;Kuth&quot;</span><span class="p">,</span> <span class="s">&quot;rk@gmail.com&quot;</span><span class="p">,</span> <span class="s">&quot;2010-01-01&quot;</span><span class="p">);</span>
        <span class="n">dao</span><span class="p">.</span><span class="na">addPerson</span><span class="p">(</span><span class="n">raj</span><span class="p">);</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">dao</span><span class="p">.</span><span class="na">getPerson</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>


    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="jdbc-continued">JDBC continued</h2>
<p>(This section is from pluralsight)</p>
<h3 id="basic-crud-operations">Basic CRUD operations</h3>
<p>Some of the databases support scorllable (forward and backward) datasets
i.e. you can go forward and back and to first and last rows e.g. MYSql,
however some of the databases like oracle or SQLite do not support this.
They are forwrad only databases.</p>
<p>Lets refactor the code to access the database into something which is
more re-useable.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// DBType.Java</span>
<span class="kd">public</span> <span class="kd">enum</span> <span class="n">DBType</span> <span class="p">{</span>
    <span class="n">SQLITEDB</span><span class="p">,</span> <span class="n">MYSQLDB</span>
<span class="p">}</span>
</code></pre></div>


<p>We also have a utility class for connections to the db object.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// DBUtil.Java</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.DriverManager</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DBUtil</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">SQLiteURL</span> <span class="o">=</span> <span class="s">&quot;jdbc:sqlite:C:/Users/182362434/dbA.db&quot;</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">MYSQLURL</span> <span class="o">=</span> <span class="s">&quot;jdbc:mysql://localhost:3306/world&quot;</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">MYSQLuser</span> <span class="o">=</span> <span class="s">&quot;admin&quot;</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">MYSQLpassword</span> <span class="o">=</span> <span class="s">&quot;admin&quot;</span><span class="p">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Connection</span> <span class="nf">getConnection</span><span class="p">(</span><span class="n">DBType</span> <span class="n">dbType</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="p">(</span><span class="n">dbType</span><span class="p">){</span>
            <span class="k">case</span> <span class="n">SQLITEDB</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">SQLiteURL</span><span class="p">);</span>
            <span class="k">case</span> <span class="n">MYSQLDB</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">MYSQLURL</span><span class="p">,</span> <span class="n">MYSQLuser</span><span class="p">,</span> <span class="n">MYSQLpassword</span><span class="p">);</span>
            <span class="k">default</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">showErrorMessage</span><span class="p">(</span><span class="n">SQLException</span> <span class="n">e</span><span class="p">){</span>
        <span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Error : &quot;</span> <span class="o">+</span> <span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
        <span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Error code : &quot;</span> <span class="o">+</span> <span class="n">e</span><span class="p">.</span><span class="na">getErrorCode</span><span class="p">());</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>


<p>Sample connection shown below.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// TestManageDBResources.Java</span>
<span class="kn">import</span> <span class="nn">java.sql.*</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestManageDBResources</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="p">{</span>

        <span class="n">Connection</span> <span class="n">con</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">try</span><span class="p">{</span>
            <span class="n">con</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">MYSQLDB</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Connection Successful&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">(</span><span class="n">SQLException</span> <span class="n">e</span><span class="p">){</span>
            <span class="n">DBUtil</span><span class="p">.</span><span class="na">showErrorMessage</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">finally</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">con</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">con</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>How to fetch data.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// TestStaticSQLStatement.Java</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Statement</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestStaticSQLStatement</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="p">{</span>

        <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="n">Statement</span> <span class="n">st</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

        <span class="k">try</span> <span class="p">{</span>
            <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">MYSQLDB</span><span class="p">);</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="s">&quot;Select * from city&quot;</span><span class="p">);</span>
            <span class="n">rs</span><span class="p">.</span><span class="na">last</span><span class="p">();</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Number of rows : &quot;</span> <span class="o">+</span> <span class="n">rs</span><span class="p">.</span><span class="na">getRow</span><span class="p">());</span>

        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">SQLException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">DBUtil</span><span class="p">.</span><span class="na">showErrorMessage</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">finally</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">rs</span> <span class="o">!=</span> <span class="kc">null</span> <span class="p">)</span>
                <span class="n">rs</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">st</span> <span class="o">!=</span> <span class="kc">null</span> <span class="p">)</span>
                <span class="n">st</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">conn</span> <span class="o">!=</span> <span class="kc">null</span> <span class="p">)</span>
                <span class="n">conn</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="p">}</span>


    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<hr />
<p>We will fetch the data again from the data base using <strong>try with
resouces</strong> block. In this case you do not need the finally block because
after try java auto closes the objects.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Statement</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">IteratingResultsetTryWithResources</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="p">{</span>

        <span class="k">try</span> <span class="p">(</span>
                <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">MYSQLDB</span><span class="p">);</span>
                <span class="n">Statement</span> <span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span>
                <span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="s">&quot;Select * from city&quot;</span><span class="p">)</span>
        <span class="p">)</span> <span class="p">{</span>

            <span class="k">while</span> <span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">next</span><span class="p">()){</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
            <span class="p">}</span>

        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">SQLException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">DBUtil</span><span class="p">.</span><span class="na">showErrorMessage</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<hr />
<p><strong>Types of resultsets</strong></p>
<p>There are different types of result sets. (Check slide or documentation
of resultsets). Some of them will be updated when database is updating
(support concurrency). Some of them are scorallable some are not. One
useful link is
<a href="https://www.tutorialspoint.com/jdbc/jdbc-result-sets.htm">this</a></p>
<p>As discussed some database do not give scrollable resultset by default,
when creating a resultset you can specify the type of resultset which
you want to get. Eample provided below.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// ResultsetScrollableDemo.Java</span>
<span class="kn">import</span> <span class="nn">java.sql.*</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ResultsetScrollableDemo</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">try</span><span class="p">(</span>
                <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">ORACLE</span><span class="p">);</span>  <span class="c1">// lets say we had oracle databasesa</span>
                <span class="c1">// creating a scrollable and read only resultset</span>
                <span class="n">Statement</span> <span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">createStatement</span><span class="p">(</span><span class="n">ResultSet</span><span class="p">.</span><span class="na">TYPE_SCROLL_INSENSITIVE</span><span class="p">,</span> <span class="n">ResultSet</span><span class="p">.</span><span class="na">CONCUR_READ_ONLY</span><span class="p">)</span> <span class="p">;</span>
                <span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="p">((</span><span class="n">Statement</span><span class="p">)</span> <span class="n">st</span><span class="p">).</span><span class="na">executeQuery</span><span class="p">(</span><span class="s">&quot;Select * from Customer&quot;</span><span class="p">);</span>

                <span class="p">){</span>

            <span class="n">rs</span><span class="p">.</span><span class="na">beforeFirst</span><span class="p">();</span>  <span class="c1">// move the cursor to before first record;</span>
            <span class="n">rs</span><span class="p">.</span><span class="na">absolute</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// goto first row</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; : &quot;</span> <span class="o">+</span> <span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>

        <span class="p">}</span><span class="k">catch</span> <span class="p">(</span><span class="n">SQLException</span> <span class="n">e</span><span class="p">){</span>
            <span class="n">DBUtil</span><span class="p">.</span><span class="na">showErrorMessage</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<hr />
<p><strong>Updatable ResultSet</strong></p>
<p>You can also create an updatable resultset. The updates in the result
set will make changes to the database. Most common methods are as
follows.</p>
<ul>
<li>updateRow() --> update to db</li>
<li>deleteRow() --> delete from db</li>
<li>refreshRow() --> refresh in rs from db</li>
<li>cancelRowUpdates() --> cancel changes in rs</li>
<li>insertRow() --> insert in db</li>
</ul>
<p>Some databases will support updateable resultsets. Using updatable
resultsets is a good approach for small datasets but for very large
datasets it will create performance issues.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Statement</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UpdatableResultSetDemo</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span><span class="p">{</span>

        <span class="k">try</span><span class="p">(</span>
                <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">ORADB</span><span class="p">);</span>

                <span class="n">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">createStatement</span><span class="p">(</span><span class="n">ResultSet</span><span class="p">.</span><span class="na">TYPE_SCROLL_INSENSITIVE</span><span class="p">,</span> <span class="n">ResultSet</span><span class="p">.</span><span class="na">CONCUR_UPDATABLE</span><span class="p">);</span>  <span class="c1">// creating updatable resultset</span>

                <span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">stmt</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="s">&quot;Select Department_Id, Department_Name, Manager_Id, Location_Id from Departments&quot;</span><span class="p">);</span>
                <span class="p">)</span>
        <span class="p">{</span>

            <span class="c1">// updating a row</span>
            <span class="n">rs</span><span class="p">.</span><span class="na">absolute</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
            <span class="n">rs</span><span class="p">.</span><span class="na">updateString</span><span class="p">(</span><span class="s">&quot;Department_Name&quot;</span><span class="p">,</span> <span class="s">&quot;Information Technology&quot;</span><span class="p">);</span>
            <span class="n">rs</span><span class="p">.</span><span class="na">updateRow</span><span class="p">();</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Record Updated Successfully&quot;</span><span class="p">);</span>

            <span class="c1">// inserting a row</span>
            <span class="n">rs</span><span class="p">.</span><span class="na">moveToInsertRow</span><span class="p">();</span>
            <span class="n">rs</span><span class="p">.</span><span class="na">updateInt</span><span class="p">(</span><span class="s">&quot;Department_Id&quot;</span><span class="p">,</span> <span class="mi">999</span><span class="p">);</span>
            <span class="n">rs</span><span class="p">.</span><span class="na">updateString</span><span class="p">(</span><span class="s">&quot;Department_Name&quot;</span><span class="p">,</span> <span class="s">&quot;Training&quot;</span><span class="p">);</span>
            <span class="n">rs</span><span class="p">.</span><span class="na">updateInt</span><span class="p">(</span><span class="s">&quot;Manager_Id&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
            <span class="n">rs</span><span class="p">.</span><span class="na">updateInt</span><span class="p">(</span><span class="s">&quot;Location_Id&quot;</span><span class="p">,</span> <span class="mi">1800</span><span class="p">);</span>
            <span class="n">rs</span><span class="p">.</span><span class="na">insertRow</span><span class="p">();</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Record Inserted Successfully&quot;</span><span class="p">);</span>

        <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span><span class="n">SQLException</span> <span class="n">ex</span><span class="p">){</span>
            <span class="n">DBUtil</span><span class="p">.</span><span class="na">showErrorMessage</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>


<p><strong>Prepared statements</strong></p>
<ul>
<li>Improves performance of the app.</li>
<li>Easy to set SQL parameter value</li>
<li>Prevent SQL dependency Injection Attacks</li>
<li>Although you can use prepared statement for objects with no
    parameter but most often you will use them for objects with
    parameters.</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="c1">// Inserting with prepared statement</span>

<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Date</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.text.ParseException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.text.SimpleDateFormat</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestPreparedInsert</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span>  <span class="p">{</span>
        <span class="c1">// TODO Auto-generated method stub</span>

         <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">ORADB</span><span class="p">);</span>

         <span class="kt">int</span> <span class="n">empno</span><span class="p">;</span>
         <span class="n">String</span> <span class="n">ename</span><span class="p">,</span><span class="n">email</span><span class="p">;</span>
         <span class="n">java</span><span class="p">.</span><span class="na">sql</span><span class="p">.</span><span class="na">Date</span> <span class="n">hiredate</span><span class="p">;</span>
         <span class="kt">double</span> <span class="n">salary</span><span class="p">;</span>

         <span class="n">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>

         <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Employee ID :&quot;</span><span class="p">);</span>
         <span class="n">empno</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">());</span>

         <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Employee Name :&quot;</span><span class="p">);</span>
         <span class="n">ename</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">();</span>

         <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Ente Email : &quot;</span><span class="p">);</span>
         <span class="n">email</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">();</span>

         <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Date of Joining : &quot;</span><span class="p">);</span>
         <span class="n">hiredate</span> <span class="o">=</span> <span class="n">java</span><span class="p">.</span><span class="na">sql</span><span class="p">.</span><span class="na">Date</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">());</span>

         <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Salary : &quot;</span><span class="p">);</span>
         <span class="n">salary</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="na">nextDouble</span><span class="p">();</span>

         <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&quot;insert into NewEmployees values ( ?,?,?,?,? )&quot;</span><span class="p">;</span>

         <span class="n">PreparedStatement</span> <span class="n">pstmt</span>  <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">sql</span><span class="p">);</span>

         <span class="n">pstmt</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">empno</span><span class="p">);</span>
         <span class="n">pstmt</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ename</span><span class="p">);</span>
         <span class="n">pstmt</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">email</span><span class="p">);</span>
         <span class="n">pstmt</span><span class="p">.</span><span class="na">setDate</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">hiredate</span><span class="p">);</span>
         <span class="n">pstmt</span><span class="p">.</span><span class="na">setDouble</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">salary</span><span class="p">);</span>

         <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">pstmt</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>

         <span class="k">if</span><span class="p">(</span> <span class="n">result</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span>
         <span class="p">{</span>
             <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Record Inserted Successfully.&quot;</span><span class="p">);</span>
         <span class="p">}</span>
         <span class="k">else</span><span class="p">{</span>
             <span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Error while adding the record.&quot;</span><span class="p">);</span>
         <span class="p">}</span>

         <span class="n">scanner</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
         <span class="n">pstmt</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
         <span class="n">conn</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>


<p>Updating the record via prepared statement</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="p">;</span>


<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestPreparedUpdate</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span>  <span class="p">{</span>

        <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">ORADB</span><span class="p">);</span>

        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&quot;Update NewEmployees set Salary = ? where Employee_Id = ?&quot;</span><span class="p">;</span>

        <span class="n">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Employee ID :&quot;</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">empno</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="na">nextInt</span><span class="p">();</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter New Salary : &quot;</span><span class="p">);</span>
        <span class="kt">double</span> <span class="n">salary</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="na">nextDouble</span><span class="p">();</span>

        <span class="n">PreparedStatement</span> <span class="n">pstmt</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">sql</span><span class="p">);</span>

        <span class="n">pstmt</span><span class="p">.</span><span class="na">setDouble</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">salary</span><span class="p">);</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">empno</span><span class="p">);</span>

        <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">pstmt</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">result</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Employee Salary Updated Successfully.&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Error while updating the Salary.&quot;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">scanner</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">conn</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>

    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>


<p>Deleting the record via prepared statement.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestPreparedStatementDelete</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="p">{</span>

        <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">ORADB</span><span class="p">);</span>

        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&quot;Delete from NewEmployees where Employee_Id = ?&quot;</span><span class="p">;</span>

        <span class="n">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Employee ID :&quot;</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">empno</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="na">nextInt</span><span class="p">();</span>

        <span class="n">PreparedStatement</span> <span class="n">pstmt</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">sql</span><span class="p">);</span>

        <span class="n">pstmt</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">empno</span><span class="p">);</span>

        <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">pstmt</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">result</span> <span class="o">==</span> <span class="mi">1</span><span class="p">){</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Employee Record Removed Successfully.&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Error While Removing Employee Record.&quot;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">scanner</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">conn</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>


<hr />
<h3 id="working-with-stored-procedures">Working with stored procedures</h3>
<p><em>Stored Procedures</em> - Stored procedures are a set of SQL statements that
perform a particular task. They are useful when you are dealing with
complex scenario which may require multiple statements. So instead of
executing multiple updates form java to JDBC we create the stored
procedure in DB and send the data to that stored procedure in DB. The
stored procedure in DB then makes the changes.</p>
<ul>
<li>Its benefitial in case of roll backs.</li>
<li>deals better with partial updates (think of multiple updates from db
    if 1 failes then we have to roll back all of them etc...)</li>
<li>performance is also better</li>
</ul>
<p>Each database has its own language for creating stored procedure. The
DBA usually creates the stored procedures. - Oracle --> PLSQL - MYSQL
--> Stored procedure language - SQLServer --> Transact SQL</p>
<p>In JDBC we use callable statements to make a call to Stored Procedures.</p>
<p><em>Demo</em></p>
<ul>
<li>create a new stored procedure AddNewEmployee in Oracle DB.</li>
<li>from jdbc call the store procedure.</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Date</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.CallableStatement</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestCallableIn</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span><span class="p">(</span>
                <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">ORADB</span><span class="p">);</span>
                <span class="c1">// statement type is prepareCall and in &quot;{}&quot;</span>
                <span class="c1">// for values we just put ?</span>
                <span class="n">CallableStatement</span> <span class="n">callableStatement</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">prepareCall</span><span class="p">(</span><span class="s">&quot;{call AddNewEmployee(?,?,?,?,?)}&quot;</span><span class="p">);</span>  <span class="c1">// callable statement</span>
                <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Employee # : &quot;</span><span class="p">);</span>
            <span class="kt">int</span> <span class="n">empno</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">());</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Employee Name : &quot;</span><span class="p">);</span>
            <span class="n">String</span> <span class="n">ename</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">();</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Email ID :&quot;</span><span class="p">);</span>
            <span class="n">String</span> <span class="n">email</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">();</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Hiredate : &quot;</span><span class="p">);</span>
            <span class="n">Date</span> <span class="n">doj</span> <span class="o">=</span> <span class="n">java</span><span class="p">.</span><span class="na">sql</span><span class="p">.</span><span class="na">Date</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">());</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Salary :&quot;</span><span class="p">);</span>
            <span class="kt">double</span> <span class="n">salary</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="na">nextDouble</span><span class="p">();</span>

            <span class="c1">// setting the values as we did for other statements</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">empno</span><span class="p">);</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ename</span><span class="p">);</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">email</span><span class="p">);</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">setDate</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">doj</span><span class="p">);</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">setDouble</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">salary</span><span class="p">);</span>

            <span class="c1">// call execute method</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">execute</span><span class="p">();</span>

            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Employee Record Added Successfully.&quot;</span><span class="p">);</span>

        <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span><span class="n">SQLException</span> <span class="n">ex</span><span class="p">){</span>
            <span class="n">DBUtil</span><span class="p">.</span><span class="na">showErrorMessage</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<hr />
<p><strong>Batch processing in JDBC</strong></p>
<ul>
<li>Each time a request is made to server we usually establish a
    connection.</li>
<li>Each time database updates java application.</li>
<li>lets say we have to insert 100 records then its 100 times to and fro
    communication between java and sql which leads to network and
    performance issues.</li>
<li>Thats why its benefitial to do batch processing.</li>
<li>We do that by creating a batch in jdbc and then submit to database.</li>
<li>The batch processing is supported by statement, preparedStatement
    and CallableStatement</li>
</ul>
<p>Methods to keep in mind</p>
<ul>
<li>void addBatch()</li>
<li>int[] executeBatch()</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Date</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.CallableStatement</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestCallableBatchProcessing</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span><span class="p">(</span>
                <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">ORADB</span><span class="p">);</span>
                <span class="n">CallableStatement</span> <span class="n">callableStatement</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">prepareCall</span><span class="p">(</span><span class="s">&quot;call AddNewEmployee(?,?,?,?,?)&quot;</span><span class="p">);</span>
                <span class="p">){</span>
            <span class="n">String</span> <span class="n">option</span><span class="p">;</span>
            <span class="k">do</span><span class="p">{</span>
                <span class="n">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Employee # : &quot;</span><span class="p">);</span>
                <span class="kt">int</span> <span class="n">empno</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">());</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Employee Name : &quot;</span><span class="p">);</span>
                <span class="n">String</span> <span class="n">ename</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">();</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Email ID :&quot;</span><span class="p">);</span>
                <span class="n">String</span> <span class="n">email</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">();</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Hiredate : &quot;</span><span class="p">);</span>
                <span class="n">Date</span> <span class="n">dob</span> <span class="o">=</span> <span class="n">java</span><span class="p">.</span><span class="na">sql</span><span class="p">.</span><span class="na">Date</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">());</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Salary :&quot;</span><span class="p">);</span>
                <span class="kt">double</span> <span class="n">salary</span> <span class="o">=</span> <span class="n">Double</span><span class="p">.</span><span class="na">parseDouble</span><span class="p">(</span><span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">());</span>

                <span class="n">callableStatement</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">empno</span><span class="p">);</span>
                <span class="n">callableStatement</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ename</span><span class="p">);</span>
                <span class="n">callableStatement</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">email</span><span class="p">);</span>
                <span class="n">callableStatement</span><span class="p">.</span><span class="na">setDate</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">dob</span><span class="p">);</span>
                <span class="n">callableStatement</span><span class="p">.</span><span class="na">setDouble</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">salary</span><span class="p">);</span>

                <span class="n">callableStatement</span><span class="p">.</span><span class="na">addBatch</span><span class="p">();</span>  <span class="c1">// adding to batch instead of executing it.</span>

                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Do You Want To Add Another Record (yes /no): &quot;</span><span class="p">);</span>
                <span class="n">option</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">();</span>
            <span class="p">}</span><span class="k">while</span><span class="p">(</span> <span class="n">option</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;yes&quot;</span><span class="p">));</span>

            <span class="kt">int</span><span class="o">[]</span> <span class="n">updateCounts</span> <span class="o">=</span> <span class="n">callableStatement</span><span class="p">.</span><span class="na">executeBatch</span><span class="p">();</span>  <span class="c1">// executing the batch, which returns array of ints.</span>

            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Total Records Inserted are : &quot;</span> <span class="o">+</span> <span class="n">updateCounts</span><span class="p">.</span><span class="na">length</span>  <span class="p">);</span>


        <span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="n">SQLException</span> <span class="n">ex</span><span class="p">){</span>
            <span class="n">DBUtil</span><span class="p">.</span><span class="na">showErrorMessage</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<hr />
<p><strong>Out parameters</strong></p>
<p>Stored procedures can not only take IN parameters but can also return
OUT parameters. e.g. in case you wish that the database does some sort
of count and returns back the value. The below example shows that the
stored procedure takes in a value of department ID and returns how many
people are in that department ID.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.sql.CallableStatement</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Types</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestCallableOut</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// TODO Auto-generated method stub</span>

        <span class="k">try</span><span class="p">(</span>
                <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">ORADB</span><span class="p">);</span>
                <span class="c1">// In case of IN or OUT parameter the callable Statement definition remains the same. i.e. we just put ? for both types of params.</span>
                <span class="c1">// In this case `GetTotalEmployeesByDepartment` is the stored procedure name.</span>
                <span class="n">CallableStatement</span> <span class="n">callableStatement</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">prepareCall</span><span class="p">(</span><span class="s">&quot;{ call GetTotalEmployeesByDepartment(?,?) }&quot;</span><span class="p">);</span>
                <span class="n">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>
                <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Department ID : &quot;</span><span class="p">);</span>
            <span class="kt">int</span> <span class="n">deptno</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">());</span>

            <span class="c1">// providing value for IN param.</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">deptno</span><span class="p">);</span>

            <span class="c1">// registring the out param.</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">registerOutParameter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Types</span><span class="p">.</span><span class="na">INTEGER</span><span class="p">);</span>

            <span class="n">callableStatement</span><span class="p">.</span><span class="na">execute</span><span class="p">();</span>

            <span class="c1">// once the statement is executed we get the value of the out param, in this case it was the 2nd param</span>
            <span class="kt">int</span> <span class="n">totalEmployees</span>  <span class="o">=</span> <span class="n">callableStatement</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Total Employees Working : &quot;</span> <span class="o">+</span> <span class="n">totalEmployees</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span><span class="n">SQLException</span> <span class="n">ex</span><span class="p">){</span>
            <span class="n">DBUtil</span><span class="p">.</span><span class="na">showErrorMessage</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<hr />
<p><strong>IN OUT parameter</strong></p>
<p>The same parameter can be used as both IN and OUT parameters. lets say
we send some value and db\'s stored procedure modify\'s the value and
then stores in teh database. Then the stored procedure returns the
updated value back to JAVA.</p>
<p>In the example below for a course, the db takes in orignal fee and
retuns the final fee as OUT parameter after calculating the discount.
(For the details of the stored procedure refer to the slides.)</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.sql.CallableStatement</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Types</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestCallableInOut</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="p">{</span>
        <span class="n">Connection</span> <span class="n">conn</span><span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="n">CallableStatement</span> <span class="n">callableStatement</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="n">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

        <span class="k">try</span><span class="p">{</span>
                 <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">ORADB</span><span class="p">);</span>
                 <span class="n">callableStatement</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">prepareCall</span><span class="p">(</span><span class="s">&quot;{call GetCourseFeesById(?,?)}&quot;</span><span class="p">);</span>
                 <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>


            <span class="c1">// Calling Stored procedure 1</span>
            <span class="c1">// Get the course details with orginal fees.</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Course ID :&quot;</span><span class="p">);</span>
            <span class="kt">int</span> <span class="n">cid</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">());</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">cid</span><span class="p">);</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">registerOutParameter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Types</span><span class="p">.</span><span class="na">DOUBLE</span><span class="p">);</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">execute</span><span class="p">();</span>
            <span class="kt">double</span> <span class="n">fees</span> <span class="o">=</span> <span class="n">callableStatement</span><span class="p">.</span><span class="na">getDouble</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Course Fees : &quot;</span> <span class="o">+</span> <span class="n">fees</span><span class="p">);</span>

            <span class="c1">// Calling Stored procedure 2</span>
            <span class="c1">// Get the student details</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Roll Number : &quot;</span><span class="p">);</span>
            <span class="kt">int</span> <span class="n">rno</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">());</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Student Name :&quot;</span><span class="p">);</span>
            <span class="n">String</span> <span class="n">sname</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">();</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter your Percentage : &quot;</span><span class="p">);</span>
            <span class="kt">double</span> <span class="n">percentage</span> <span class="o">=</span> <span class="n">Double</span><span class="p">.</span><span class="na">parseDouble</span><span class="p">(</span><span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">());</span>
            <span class="n">callableStatement</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">prepareCall</span><span class="p">(</span><span class="s">&quot;{ call EnrollStudent(?,?,?,?,?) }&quot;</span><span class="p">);</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="s">&quot;rno&quot;</span><span class="p">,</span> <span class="n">rno</span><span class="p">);</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="s">&quot;sname&quot;</span><span class="p">,</span> <span class="n">sname</span><span class="p">);</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="s">&quot;cid&quot;</span><span class="p">,</span> <span class="n">cid</span><span class="p">);</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">setDouble</span><span class="p">(</span><span class="s">&quot;cfees&quot;</span><span class="p">,</span> <span class="n">fees</span><span class="p">);</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">setDouble</span><span class="p">(</span><span class="s">&quot;spercent&quot;</span><span class="p">,</span> <span class="n">percentage</span><span class="p">);</span>
            <span class="c1">// Register the same variale as OUT parameter which was used as IN parameter also.</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">registerOutParameter</span><span class="p">(</span><span class="s">&quot;cfees&quot;</span><span class="p">,</span> <span class="n">Types</span><span class="p">.</span><span class="na">DOUBLE</span><span class="p">);</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">execute</span><span class="p">();</span>
            <span class="c1">// get the value sent by the database</span>
            <span class="n">fees</span> <span class="o">=</span> <span class="n">callableStatement</span><span class="p">.</span><span class="na">getDouble</span><span class="p">(</span><span class="s">&quot;cfees&quot;</span><span class="p">);</span>
            <span class="c1">// display it.</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">sname</span> <span class="o">+</span> <span class="s">&quot; enrolled for the Course with the ID &quot;</span> <span class="o">+</span> <span class="n">cid</span> <span class="o">+</span> <span class="s">&quot; and Final Fees is &quot;</span> <span class="o">+</span> <span class="n">fees</span><span class="p">);</span>


        <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span><span class="n">SQLException</span> <span class="n">ex</span><span class="p">){</span>
            <span class="n">DBUtil</span><span class="p">.</span><span class="na">showErrorMessage</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">finally</span><span class="p">{</span>
            <span class="n">scanner</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
            <span class="n">conn</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<hr />
<p><strong>Stored procedure returning ResultSets</strong></p>
<p>A stored procedure can also return a resultset. In the example below a
stored procedure is returning a oracle cursor. We then need to type cast
that to resultset and then loop on it. (Personal opinion --> looks like
a lot of boilerplate code, ORM might be better or some DBUtils packages)</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.sql.CallableStatement</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">oracle.jdbc.internal.OracleCallableStatement</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">oracle.jdbc.OracleTypes</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestCallableResultSet</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="p">{</span>
        <span class="c1">// TODO Auto-generated method stub</span>
        <span class="k">try</span><span class="p">(</span>
                <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">ORADB</span><span class="p">);</span>
                <span class="c1">// same as always teh 2nd param will be the resultset</span>
                <span class="n">CallableStatement</span> <span class="n">callableStatement</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">prepareCall</span><span class="p">(</span><span class="s">&quot;{call GetEmployeesByRefCursor(?,?)}&quot;</span><span class="p">);</span>
                <span class="n">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>
                <span class="p">){</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Department ID : &quot;</span><span class="p">);</span>
            <span class="kt">int</span> <span class="n">deptno</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">());</span>

            <span class="n">callableStatement</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">deptno</span><span class="p">);</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">registerOutParameter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">OracleTypes</span><span class="p">.</span><span class="na">CURSOR</span><span class="p">);</span>  <span class="c1">// notice the type</span>
            <span class="n">callableStatement</span><span class="p">.</span><span class="na">execute</span><span class="p">();</span>

            <span class="c1">// typecast what is returned to resultset</span>
            <span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="p">((</span><span class="n">oracle</span><span class="p">.</span><span class="na">jdbc</span><span class="p">.</span><span class="na">internal</span><span class="p">.</span><span class="na">OracleCallableStatement</span><span class="p">)</span><span class="n">callableStatement</span><span class="p">).</span><span class="na">getCursor</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

            <span class="n">String</span> <span class="n">format</span> <span class="o">=</span> <span class="s">&quot;%-4s%-50s%-25s%-10f\n&quot;</span><span class="p">;</span>

            <span class="c1">// loop and display values.</span>
            <span class="k">while</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">next</span><span class="p">()){</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="n">format</span><span class="p">,</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;Employee_ID&quot;</span><span class="p">),</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;Employee_Name&quot;</span><span class="p">),</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;Email&quot;</span><span class="p">),</span><span class="n">rs</span><span class="p">.</span><span class="na">getFloat</span><span class="p">(</span><span class="s">&quot;Salary&quot;</span><span class="p">));</span>
            <span class="p">}</span>

        <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span><span class="n">SQLException</span> <span class="n">ex</span><span class="p">){</span>
            <span class="n">DBUtil</span><span class="p">.</span><span class="na">showErrorMessage</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
        <span class="p">}</span>

    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>


<h3 id="transaction-management-using-jdbc">Transaction Management using JDBC</h3>
<p>Lets say we have 2 people. We are deducting \$100 from personA and
depositing to personB. The first operation of deductoin passes but the
next one of deposit to personB fails.</p>
<p>In this case transaction management can be used to specify commit all or
rollback all.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestTransactionManagement</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span><span class="p">{</span>

    <span class="k">try</span><span class="p">{</span>
        <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">ORADB</span><span class="p">);</span>
        <span class="c1">// set the auto commit functionality to false.</span>
        <span class="n">conn</span><span class="p">.</span><span class="na">setAutoCommit</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

        <span class="n">PreparedStatement</span> <span class="n">pstmt</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="n">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">in</span><span class="p">);</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;PSBank Transactions&quot;</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;----------------------&quot;</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter From Account # :&quot;</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">fromAcno</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">());</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter To Account # : &quot;</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">toAcno</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">());</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Enter Amount To Transfer : &quot;</span><span class="p">);</span>
        <span class="kt">double</span> <span class="n">amount</span> <span class="o">=</span> <span class="n">Double</span><span class="p">.</span><span class="na">parseDouble</span><span class="p">(</span><span class="n">scanner</span><span class="p">.</span><span class="na">nextLine</span><span class="p">());</span>

        <span class="n">String</span> <span class="n">withdrawSQL</span> <span class="o">=</span> <span class="s">&quot;Update PSBank set Amount = Amount - ? where Acno = ?&quot;</span><span class="p">;</span>
        <span class="n">pstmt</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">withdrawSQL</span><span class="p">);</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">setDouble</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">amount</span><span class="p">);</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">fromAcno</span><span class="p">);</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>

        <span class="n">String</span> <span class="n">depositSQL</span> <span class="o">=</span> <span class="s">&quot;Update PSBank set Amount = Amount + ? where Acno = ?&quot;</span><span class="p">;</span>
        <span class="n">pstmt</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">depositSQL</span><span class="p">);</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">setDouble</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">amount</span><span class="p">);</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">toAcno</span><span class="p">);</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>

        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&quot;Select Amount From PSBank where Acno = ?&quot;</span><span class="p">;</span>
        <span class="n">pstmt</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">sql</span><span class="p">);</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">fromAcno</span><span class="p">);</span>
        <span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">pstmt</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">();</span>
        <span class="kt">double</span> <span class="n">balanceAmount</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">rs</span><span class="p">.</span><span class="na">next</span><span class="p">()){</span>
            <span class="n">balanceAmount</span> <span class="o">=</span> <span class="n">rs</span><span class="p">.</span><span class="na">getDouble</span><span class="p">(</span><span class="s">&quot;Amount&quot;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">balanceAmount</span> <span class="o">&gt;=</span> <span class="mi">5000</span><span class="p">){</span>
            <span class="c1">// if everything is ok we then commit.</span>
            <span class="n">conn</span><span class="p">.</span><span class="na">commit</span><span class="p">();</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Amount Transferred Successfully...&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="c1">// else we rollback.</span>
            <span class="n">conn</span><span class="p">.</span><span class="na">rollback</span><span class="p">();</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Insufficient Funds : &quot;</span> <span class="o">+</span> <span class="n">balanceAmount</span> <span class="o">+</span> <span class="s">&quot; Transactions Rollbacked..&quot;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">scanner</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">conn</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">){</span>
            <span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>


<h3 id="working-with-clob-and-blob">Working with CLOB and BLOB</h3>
<p><strong>CLOB</strong></p>
<ul>
<li>
<p>CLOB -> (Character Large Object) is a collection of character data
    stored in database as single entity. Used to store large text
    documents e.g. plain text or xml. Also not all database support
    CLOB. MYSQL you need to use LongText which can store upto 4GB data.
    In ORACLE we use CLOB.</p>
<ul>
<li>In order to store the file we need to get the file.</li>
<li>Read the contents of the file with help of any input stream
    reader.</li>
<li>Convert contents to character with help of any ASCI string</li>
<li>Then pass to database using prepared statement or callable
    statement</li>
<li>In order to read the CLOB data from database use getClob()</li>
</ul>
</li>
</ul>
<p>Inserting CLOB data</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.io.File</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileNotFoundException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileReader</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">InsertCLOBDataToEmpResume</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span><span class="p">,</span> <span class="n">FileNotFoundException</span><span class="p">{</span>

        <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">ORADB</span><span class="p">);</span>
        <span class="n">PreparedStatement</span> <span class="n">pstmt</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

        <span class="c1">// creating the prepared statement the same way.</span>
        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&quot;Update NewEmployees set Resume = ? where Employee_ID = 500&quot;</span><span class="p">;</span>
        <span class="n">pstmt</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">sql</span><span class="p">);</span>

        <span class="c1">// read the contents of the file</span>
        <span class="n">String</span> <span class="n">resumeFile</span> <span class="o">=</span> <span class="s">&quot;d:/PluralSight Demos/SekharResume.txt&quot;</span><span class="p">;</span>
        <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">resumeFile</span><span class="p">);</span>
        <span class="n">FileReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileReader</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>

        <span class="c1">// Set the file reader into the prepared statement</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">setCharacterStream</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">file</span><span class="p">.</span><span class="na">length</span><span class="p">());</span>

        <span class="c1">// execute the prepared statement to store the file in database</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Resume Updated Successfully...&quot;</span><span class="p">);</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">conn</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<hr />
<p><em>Fetch CLOB data from DB</em></p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.io.FileWriter</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.io.Reader</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Clob</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RetrieveCLOBDataFromDB</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span><span class="p">,</span> <span class="n">IOException</span><span class="p">{</span>
        <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">ORADB</span><span class="p">);</span>

        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&quot;select Resume from NewEmployees where Employee_ID = 500&quot;</span><span class="p">;</span>

        <span class="n">PreparedStatement</span> <span class="n">pstmt</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">sql</span><span class="p">);</span>
        <span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">pstmt</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">();</span>

        <span class="k">if</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">next</span><span class="p">()){</span> <span class="c1">// fetch the first row in RS</span>
            <span class="n">Clob</span> <span class="n">resume</span> <span class="o">=</span> <span class="n">rs</span><span class="p">.</span><span class="na">getClob</span><span class="p">(</span><span class="s">&quot;Resume&quot;</span><span class="p">);</span>
            <span class="n">Reader</span> <span class="n">data</span> <span class="o">=</span> <span class="n">resume</span><span class="p">.</span><span class="na">getCharacterStream</span><span class="p">();</span>

            <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
            <span class="n">String</span> <span class="n">resumeDetails</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>

            <span class="c1">// conctenate the characters to create a file</span>
            <span class="k">while</span><span class="p">(</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="na">read</span><span class="p">())</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="p">){</span>
                <span class="n">resumeDetails</span> <span class="o">+=</span> <span class="p">((</span><span class="kt">char</span><span class="p">)</span> <span class="n">i</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Resume Details for Employee 500&quot;</span><span class="p">);</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">resumeDetails</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No Record Found For Employee With The ID 500.&quot;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">rs</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">conn</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<hr />
<p><strong>BLOB Data</strong></p>
<p>Blob data stands for Binary Large Object. E.g. Pictures, documents
etc...</p>
<p>Sending data to DB</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.io.File</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileInputStream</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">InsertImageWithinDB</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span><span class="p">,</span> <span class="n">IOException</span><span class="p">{</span>
        <span class="c1">// TODO Auto-generated method stub</span>

        <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">ORADB</span><span class="p">);</span>

        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&quot;Update NewEmployees Set Photo = ? where Employee_ID = 500&quot;</span><span class="p">;</span>

        <span class="n">PreparedStatement</span> <span class="n">pstmt</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">sql</span><span class="p">);</span>

        <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="s">&quot;D:/PluralSight Demos/Sekhar.jpg&quot;</span><span class="p">);</span>

        <span class="n">FileInputStream</span> <span class="n">fis</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>

        <span class="n">pstmt</span><span class="p">.</span><span class="na">setBinaryStream</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">fis</span><span class="p">,</span> <span class="n">fis</span><span class="p">.</span><span class="na">available</span><span class="p">());</span>

        <span class="kt">int</span> <span class="n">count</span>  <span class="o">=</span> <span class="n">pstmt</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Total Records Updated : &quot;</span> <span class="o">+</span> <span class="n">count</span><span class="p">);</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">conn</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>

    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>


<p>Retrive BLOB data from DB</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Blob</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RetrieveImageFromDB</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span><span class="p">,</span> <span class="n">IOException</span> <span class="p">{</span>
        <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DBUtil</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">DBType</span><span class="p">.</span><span class="na">ORADB</span><span class="p">);</span>

        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&quot;Select Photo From NewEmployees Where Employee_Id = 500&quot;</span><span class="p">;</span>
        <span class="n">PreparedStatement</span> <span class="n">pstmt</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">sql</span><span class="p">);</span>

        <span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">pstmt</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">();</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">rs</span><span class="p">.</span><span class="na">next</span><span class="p">()){</span>
            <span class="n">Blob</span> <span class="n">imgBlob</span> <span class="o">=</span> <span class="n">rs</span><span class="p">.</span><span class="na">getBlob</span><span class="p">(</span><span class="s">&quot;Photo&quot;</span><span class="p">);</span>

            <span class="n">FileOutputStream</span> <span class="n">fos</span>  <span class="o">=</span> <span class="k">new</span> <span class="n">FileOutputStream</span><span class="p">(</span><span class="s">&quot;D:/PluralSight Demos/Downloads/img500.jpg&quot;</span><span class="p">);</span>

            <span class="n">fos</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">imgBlob</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">imgBlob</span><span class="p">.</span><span class="na">length</span><span class="p">()));</span>

            <span class="n">fos</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span>
            <span class="n">fos</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>

            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Photo of Employee 500 has been Downloaded successfully&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Employee Record Not Found.&quot;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">rs</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">pstmt</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">conn</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<h3 id="working-with-metadata">Working with metadata</h3>
<p>Check slides and programs</p>
<h3 id="connection-pooling">Connection pooling</h3>
<p>Usually each request to DB will not create its own connection to DB (as
establishing a connection to DB is very time consuming.) We use the
connection pooling to request already established connections to the
database and get the logical link to it (not the physical connection
itself). Once the transaction to DB is complete we send back the
connection to the connection pool.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Statement</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.sql.PooledConnection</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">oracle.jdbc.pool.OracleConnectionPoolDataSource</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConnectionPoolingDemo</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="p">{</span>

        <span class="n">OracleConnectionPoolDataSource</span> <span class="n">ds</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OracleConnectionPoolDataSource</span><span class="p">();</span>

        <span class="n">ds</span><span class="p">.</span><span class="na">setDriverType</span><span class="p">(</span><span class="s">&quot;thin&quot;</span><span class="p">);</span>
        <span class="n">ds</span><span class="p">.</span><span class="na">setServerName</span><span class="p">(</span><span class="s">&quot;localhost&quot;</span><span class="p">);</span>
        <span class="n">ds</span><span class="p">.</span><span class="na">setPortNumber</span><span class="p">(</span><span class="mi">1521</span><span class="p">);</span>
        <span class="n">ds</span><span class="p">.</span><span class="na">setServiceName</span><span class="p">(</span><span class="s">&quot;xe&quot;</span><span class="p">);</span>
        <span class="n">ds</span><span class="p">.</span><span class="na">setUser</span><span class="p">(</span><span class="s">&quot;hr&quot;</span><span class="p">);</span>
        <span class="n">ds</span><span class="p">.</span><span class="na">setPassword</span><span class="p">(</span><span class="s">&quot;hr&quot;</span><span class="p">);</span>

        <span class="n">PooledConnection</span> <span class="n">pconn</span> <span class="o">=</span> <span class="n">ds</span><span class="p">.</span><span class="na">getPooledConnection</span><span class="p">();</span>

        <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">pconn</span><span class="p">.</span><span class="na">getConnection</span><span class="p">();</span>
        <span class="n">Statement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span>
        <span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">stmt</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="s">&quot;Select * From Departments&quot;</span><span class="p">);</span>

        <span class="n">String</span> <span class="n">format</span> <span class="o">=</span> <span class="s">&quot;%-30s%-50s%-25s\n&quot;</span><span class="p">;</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="n">format</span><span class="p">,</span><span class="s">&quot;Department #&quot;</span><span class="p">,</span><span class="s">&quot;Department Name&quot;</span><span class="p">,</span><span class="s">&quot;Location&quot;</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="n">format</span><span class="p">,</span><span class="s">&quot;-------------&quot;</span><span class="p">,</span><span class="s">&quot;-----------------&quot;</span><span class="p">,</span><span class="s">&quot;-------------&quot;</span><span class="p">);</span>

        <span class="k">while</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">next</span><span class="p">()){</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="n">format</span><span class="p">,</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;Department_ID&quot;</span><span class="p">),</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;Department_Name&quot;</span><span class="p">),</span> <span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;Location_Id&quot;</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="n">rs</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">stmt</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">conn</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
        <span class="n">pconn</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../Java-core_platform.org/" title="Java core platform.org" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Java core platform.org
              </div>
            </div>
          </a>
        
        
          <a href="../Java-design_patterns_creational.org/" title="Java design patterns creational.org" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Java design patterns creational.org
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/squidfunk" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/squidfunk" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://linkedin.com/in/squidfunk" target="_blank" rel="noopener" title="linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.d710d30a.min.js"></script>
      <script src="../../assets/javascripts/bundle.5f27aba8.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ["tabs"],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.27c6a5e6.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>